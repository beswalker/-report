---
title: "Нечеткое моделирование в оценке риска здоровью населения от загрязнения ОС"
author: "Кузьмин Дмитрий Юрьевич, группа М610М"
date: "21 декабря 2017 года"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Введение

<p align="justify">В атмосферный воздух, почву и водные объекты города поступает большое количество различных вредных веществ. Повсеместно выбрасываются такие вредные вещества, как пыль (взвешенные вещества), диоксид серы, диоксид азота, оксид углерода, которые принято называть основными, а также различные специфические вещества, выбрасываемые отдельными производствами, предприятиями, цехами.<p/>

<p align="justify">Данные медицинской статистики развитых стран показывают, что в связи с ростом воздействия вредных факторов промышленного производства и загрязнения окружающей среды возрастает частота многих хронических патологических процессов: заболеваний органов дыхания, почек, хронических отравлений, аллергических процессов, злокачественных опухолей и болезней крови.[1]<p/>

<p align="justify">Система медико-экологического регламентирования основана на предположении о том, что загрязнение окружающей среды создает опасность для здоровья человека. Основанием для этого служат, во-первых, многочисленные жалобы населения, проживающего в условиях загрязненной окружающей среды, на неприятные запахи, головные боли, общее плохое самочувствие и другие дискомфортные состояния; во-вторых, данные медицинской статистики, свидетельствующие о тенденции к росту заболеваемости на загрязненных территориях; в-третьих, данные специальных научных исследований, направленных на определение количественных характеристик связи между загрязнением окружающей среды и его влиянием на организм.<p/>

<p align="justify">В связи с этим оценка риска здоровью человека, обусловленного загрязнением окружающей среды, является в настоящее время одной из важнейших медико-экологических проблем. важнейших медико-экологических проблем. Однако существует значительная неопределенность в определении понятия риска здоровью и установлении факта воздействия загрязняющих веществ на человека и его количественных характеристик.[2,3]<p/>

<p align="justify">Поэтому для решения данной задачи предлагается использовать нечеткую логику и нечеткое моделлирование.<p/>
    
## Методы исследования

<p align="justify">Нечеткая модель — математическая модель, в основе вычисления которой лежит нечеткая логика. К построению таких моделей прибегают в случае, когда предмет исследования имеет очень слабую формализацию, и его точное математическое описание слишком сложное или просто не известно. Качество выходных значений этих моделей (погрешность модели) напрямую зависит только от эксперта, который составлял и настраивал модель. Для минимизации ошибки лучшим вариантом будет составление максимально полной и исчерпывающей модели и последующая ее настройка средствами машинного обучения на большой обучающей выборке.<p/>

<p align="justify">Ход построения модели можно разделить на три основных этапа:<p/>

* Определение входных и выходных параметров модели;
* Построение базы знаний;
* Выбор одного из методов нечеткого логического вывода.


<p align="justify">От первого этапа непосредственно зависят два других, и именно он определяет будущее функционирование модели. База знаний или, как по-другому ее называют, база правил — это совокупность нечетких правил вида: "если, то", определяющих взаимосвязь между входами и выходами исследуемого объекта. Количество правил в системе не ограниченно и также определяется экспертом. Обобщенный формат нечетких правил такой:<p/>

$$ЕСЛИ \ \ | условие (посылка) \ правила| , \ ТО \ \ | заключение \ правила| $$

<p align="justify">Условие правила характеризует текущее состояние объекта, а заключение — то, как это условие повлияет на объект. Общий вид условий и заключений нельзя выделить, так как они определяются нечетким логическим выводом.<p/>

<p align="justify">Каждое правило в системе имеет вес — данный параметр характеризует значимость правила в модели. Весовые коэффициенты присваиваются правилу в диапазоне [0, 1]. Во многих примерах нечетких моделей, которые можно встретить в литературе, данные веса не указаны, но это не означает, что их нет, в действительности для каждого правила из базы в таком случае вес фиксирован и равен единице. Условия и заключения для каждого правила могут быть двух видов:<p/> 

* простое — в нем участвует одна нечеткая переменная;
* составное — участвуют несколько нечетких переменных.

<p align="justify">В зависимости от созданной базы знаний для модели определяется система нечеткого логического вывода. Нечетким логическим выводом называется получение заключения в виде нечеткого множества, соответствующего текущим значениях входов, с использованием нечеткой базы знаний и нечетких операций. Двумя основными типами нечеткого логического вывода являются Мамдани и Сугено.<p/>

<p align="justify">Нечеткий логический вывод по алгоритму Мамдани выполняется по нечеткой базе знаний:<p/> 

$$if \ (X_1 \ is \ a_{m,1}) \ and \ (X_2 \ is \ a_{m,2}) \ and \ ... \ and \ (X_n \ is \ a_{m,n}) \ then \ (Y \ is \ d_m)(W_m)$$

<p align="justify">Значения входных и выходной переменной в ней заданы нечеткими множествами.<p/> 
<p align="justify">Эту базу также можно записать как:<p/>

$$\cap^m_{j=1} \ (\cap^n_{i=1} \ X_i \ = \ a_{j,i} \ with \ weight \ W_j)  \mapsto \ Y \ = \ d_j$$
<p align="justify">где:<p/>

* $X = (X_1, X_2, X_3 ... X_n)$ — вектор входных переменных;
* $Y$— выходная переменная;
* $a_j = (a_{j,1}, a_{j,2}, a_{j,3} ... a_{j,n})$— вектор значений входных переменных в $j$-м правиле, $j=0,1,2...m$;
* $d = (d_1, d_2, d_3, ... , d_m)$— вектор значений выходной переменной;
* $W_j$— вес j-го правила, $j=0,1,2...m$.

<p align="justify">Введем новое обозначение:  $\mu_t(v)$— функция принадлежности входной или выходной нечеткой переменной $v$ нечеткому терму $t$.<p/> 
<p align="justify">Степени принадлежности входного вектора нечетким термам $d_j$ из базы знаний рассчитываются следующим образом:<p/>
$\mu^m_j(X) \ = \vee^m_{j=1}W_j \ .\  \wedge^n_{i=1}[\mu_{a_{j,i}}\ (x_i) ]$ — данная функция будет характеризовать результат работы j-го правила из базы знаний;
<p align="justify">где  $\vee (\wedge)$— операция из $s$-нормы ($t$-нормы), т.е. из множества реализаций логической операции $ИЛИ \ (И)$. Наиболее часто используются следующие реализации: для операции ИЛИ — нахождение максимума и для операции $И$ — нахождение минимума.<p/>
<p align="justify">После нахождения $\mu_{d_j}$ для $\forall_{j}$ мы получим $m$ новых функций принадлежности, которые в совокупности будут образовывать новое нечеткое множество, обозначим его \tilde{Y}, соответствующее входному вектору $X$.<p/>

$$\tilde{Y} \ = \  \frac{\mu_{d_1}(X)}{d_1} \ + \ \frac{\mu_{d_2}(X)}{d_2} \ + \ ...\ +\ \frac{\mu_{d_m}(X)}{d_m} $$ 

<p align="justify">Особенностью этого нечеткого множества является то, что универсальным множеством для него является терм-множество выходной переменной.<p/>
<p align="justify">Далее необходимо:<p/>

* "срезать" функции принадлежности $\mu_{d_j}(Y)$ на уровне $\mu_{d_j}(X)$ ;
*  объединить полученные нечеткие множества.

<p align="justify">Иными словами, используя термины нечеткой логики, произвести импликацию и агрегацию условий. Импликация моделируется двумя методами: нахождением минимума или произведения множеств, агрегация — нахождением максимума или суммы множеств.<p/>

<p align="justify">После этого мы получим результирующее нечеткое множество, дефаззификация которого и даст нам точный выход системы.<p/> 

<p align="justify">Нечеткая модель анализирует различные параметры ОС, такие как:<p/>

*	загрязнение атмосферного воздуха;
*	загрязнение водных объектов;
*	загрязнение почвы;
*	шумовое загрязнение;
*	электромагнитное воздействие.

<p align="justify">Также существуют потенциально неизвестные параметры, которые могут повлиять на оценку, но которые трудно проанализировать:<p/>

*	природные явления (грозы, ураганы, землетрясения и др.);
* генетическая особенность человека.

<p align="justify">В результате воздействия таких факторов сложно оценить риск здоровью человека от загрязнения ОС.
К примеру все параметры ОС могут быть сильно загрязняны, но благодаря генетической особенности человек он может спокойно переносить данную экологическую ситуацию дольше чем человек у которого нет такой особенности. <p/>

## Результаты работы

<p align="justify">В результате работы была получена модель системы оценки риска здоровью населения от загрязнения ОС со следующими переменными (признаками):<p/>

*	загрязнение атмосферного воздуха, в %. Признак означает степень загрязнения воздуха на определенной территории. Загрязнение ОТ 40 ДО 60 % будем считать нормальным, от 60 до 100 критическим, от 0 до 40 малым. 
*	загрязнение водных объектов, в %. Признак означает степень загрязнения водного объекта на определенной территории.Загрязнение от 30 до 70 % будем считать нормальным, от 70 до 100 критическим, от 0 до 30 малым.
*	оценка риска здоровью, в %. Признак показывает степень риска проживания на данной территории для здоровья населения. Риск может быть малый, средний, большой.

<p align="justify">Опишем правила для оценки риска здоровью населения:<p/>

*	если загрязнение воздуха маленькое, то риск маленький;
*	если загрязнение воздуха нормальное, то риск большой;
*	если загрязнение воды нормальное, то риск средний;           
*	если загрязнение воды маленькое, то риск маленький; 
*	если загрязнение воды нормальное, то риск большой; 
*	если загрязнение воды нормальное и загрязнение воздуха нормальное, то риск средний.

<p align="justify">Для проверки работы системы были заданы исходные значения:<p/>

*	загрязнение воздуха – 20 %;
*	загрязнение воды – 95%.

<p align="justify">На рисунке 1 представлен результат работы модели.<p/>

```{r, echo=FALSE, warning=FALSE}
library("sets")
sets_options("universe", seq(from=0, to=100, by=0.1))
var<-set(AIR=fuzzy_variable(
                           SMALL=fuzzy_triangular(corners = c(-1,0,40)),
                           NORMAL=fuzzy_triangular(corners = c(40,50,60)),                         
                           CRITICAL=fuzzy_triangular(corners = c(60,100,110))
                           ), 
         WATER=fuzzy_variable(
                          SMALL=fuzzy_triangular(corners = c(-1,0,30)),
                          NORMAL=fuzzy_triangular(corners = c(30,45,70)), 
                          CRITICAL=fuzzy_triangular(corners = c(70,100,110))
                          ), 

         RISK=fuzzy_variable(
                              SMALL=fuzzy_triangular(corners = c(-1,0,30)),
                              EVERAGE=fuzzy_triangular(corners = c(25,55,75)), 
                              BIG=fuzzy_triangular(corners = c(70,100,110))
                          )
         )
         
rulez<-set(fuzzy_rule(AIR %is% SMALL, RISK %is% SMALL),
           fuzzy_rule(AIR %is% CRITICAL, RISK %is% SMALL),
           fuzzy_rule(AIR %is% NORMAL, RISK %is% BIG),
           fuzzy_rule(WATER %is% NORMAL, RISK %is% EVERAGE),
           fuzzy_rule(WATER %is% SMALL, RISK %is% SMALL),
           fuzzy_rule(WATER %is% NORMAL, RISK %is% BIG),
           fuzzy_rule(WATER %is% CRITICAL, RISK %is% BIG),
           fuzzy_rule(WATER %is% CRITICAL && AIR %is% SMALL, RISK %is% EVERAGE))
system<-fuzzy_system(var,rulez)

x<-c(20,95)
names(x)<-c("AIR","WATER")
fi<-fuzzy_inference(system,x)
summary(fi)
layout (matrix (c (1,2,3,4), 2, 2))
plot(system)
par(new=TRUE)
plot(fi)
```
<p align="justify">Рис. 1 – Результат работы модели. На верхних и первом нижнем графике показаны функций принадлежности лингвистических переменных для признаков системы, четвертый – график кривой функции принадлежности, соответствующей выходной лингвистической переменной.<p/>


<p align="justify">Однако для того чтобы выдать управленческое решение необходимо знать точное значение состояния атмосферного воздуха. Для этого проведем дефаззификацию, под которой в системах нечеткого вывода понимают процесс перехода от функции принадлежности выходной лингвистической переменной к её четкому (числовому) значению. Дефазификация проводится методом центра тяжести.<p/>

```{r, echo=FALSE, warning=FALSE}
gset_defuzzify(fi,"centroid")
```

<p align="justify">В результате работы модели получен результат в 53,8%, что означает средний риск для здоровья населения. В данной модели учтены не все параметры влияющие на результат , поэтому данный вывод является предварительным<p/>

<p align="justify">Расчеты носят теоретический характер и с выборочными данными работа пока не проводиться. <p/>

## Заключение

<p align="justify">Целью работы была разработка модели системы на основе нечеткой логики для оценки риска здоровью населения. В результате работы была реализована модель данной системы, однако были описаны не все параметры влияющие на оценку риска, а также были прописаны не все правила. Хотя модель и является неполной даже сейчас она может выдавать приблизительно достоверную оценку риска.<p/>

<p align="justify">В дальнейшем требуется доработать модель расширив количество переменных и увеличив количество правил. Также к модели можно подключить блок управленческих решений превратив модель из просто анализирующей в полноценную систему поддержки принятия решений<p/>


## Список используемой литературы

1.  Безуглая Э.Ю. Мониторинг состояния загрязнения атмосферы в городах / Э.Ю. Безуглая. Л.: Изд-во Гидрометеоиздат, 1986.- 196 с.
2.  Акимова Т.А. Экология. Человек- Экономика — Биота Среда: Учебник для вузов.- 2-е изд., перераб. и доп. / Т.А. Акимова, В.В. Хаскин. - М.: Изд-во Юнити-Дана, 2002.-566с.
3.  Алексеенко В.А. Биосфера и жизнедеятельность. Учебное пособие / В.А. Алексеенко, Л.П. Алексеенко. М.: Изд-во Логос, 2002. -212 е.: ил.
4.	Малышев  Н. Г. и др. Нечеткие модели для экспертных систем в САПР. М.: Энергоатомиздат,1991. 136с.







